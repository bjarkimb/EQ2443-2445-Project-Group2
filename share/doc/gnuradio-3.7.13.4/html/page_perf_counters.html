<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>GNU Radio Manual and C++ API Reference: Performance Counters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gnuradio_logo_icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GNU Radio Manual and C++ API Reference
   &#160;<span id="projectnumber">3.7.13.4</span>
   </div>
   <div id="projectbrief">The Free &amp; Open Software Radio Ecosystem</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_perf_counters.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Performance Counters </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="pc_introduction"></a>
Introduction</h1>
<p>Each block can have a set of Performance Counters that the schedule keeps track of. These counters measure and store information about different performance metrics of their operation. The concept is fairly extensible, but currently, GNU Radio defines the following Performance Counters:</p>
<ul>
<li>noutput_items: number of items the block can produce. </li>
<li>nproduced: the number of items the block produced. </li>
<li>input_buffers_full: % of how full each input buffer is. </li>
<li>output_buffers_full: % of how full each output buffer is. </li>
<li>work_time: number of CPU ticks during the call to general_work(). </li>
<li>work_time_total: Accumulated sum of work_time.</li>
</ul>
<p>For each Performance Counter except the work_time_total, we can retrieve the instantaneous, average, and variance from the block. Access to these counters is done through a simple set of functions added to every block in the flowgraph:</p>
<div class="fragment"><div class="line"><span class="keywordtype">float</span> pc_&lt;name&gt;[_&lt;type&gt;]();</div></div><!-- fragment --><p>In the above, the &lt;name&gt; field is one of the counters in the above list of counters. The optional &lt;type&gt; suffix is either 'avg' to get the average value or 'var' to get the variance. Without a suffix, the function returns the most recent instantaneous value.</p>
<p>We can also reset the Performance Counters back to zero to remove any history of the current average and variance calculations for a particular block.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> reset_perf_counters();</div></div><!-- fragment --><h1><a class="anchor" id="pc_config"></a>
Compile-time and Run-time Configuration</h1>
<p>Because the Performance Counters are calculated during each call to work for every block, they increase the computational cost and memory overhead. The more blocks used, the more impact this may have. So while it turns out after some experimentation that the Performance Counters add very little overhead (less than 1% speed degradation for a 24-block flowgraph), we err on the side of minimizing overhead in the scheduler. To do so, we have added compile-time and run-time configuration of the use of Performance Counters.</p>
<h2><a class="anchor" id="pc_config_compile"></a>
Compile-time Config</h2>
<p>By default, GNU Radio will build without Performance Counters enabled. To enable Performance Counters, we pass the following flag to cmake:</p>
<div class="fragment"><div class="line">-DENABLE_PERFORMANCE_COUNTERS=True</div></div><!-- fragment --><p>Note that this affects the GNU Radio block class and the scheduler itself. Out-of-tree projects will inherit directly from GNU Radio because of the inheritance with <a class="el" href="classgr_1_1block.html" title="The abstract base class for all &#39;terminal&#39; processing blocks.A signal processing flow is constructed ...">gr::block</a>. Turning on Performance Counters for GNU Radio will require a recompilation of the OOT project but no extra configuration.</p>
<h2><a class="anchor" id="pc_config_runtime"></a>
Run-time Config</h2>
<p>Given the Performance Counters are enabled in GNU Radio at compile-time, we can still control if they are used or not at run-time. For this, we use the GNU Radio preferences file in the section [PerfCounters]. This section is installed into the gnuradio-runtime.conf file. As usual with the preferences, this section or any of the individual options can be overridden in the user's config.conf file or using a GR_CONF_ environmental variable (see <a class="el" href="page_prefs.html#prefs">Configuration / Preference Files</a> for more details).</p>
<p>The options for the [PerfCounters] section are:</p>
<ul>
<li>on: Turn counters on/off at run-time. </li>
<li>export: Allow counters to be exported over ControlPort. </li>
<li>clock: sets the type of clock used when calculating work_time ('thread' or 'monotonic').</li>
</ul>
<h1><a class="anchor" id="pc_perfmonitor"></a>
Performance Monitor</h1>
<p>See <a class="el" href="page_ctrlport.html#perfmonitor">Performance Monitor</a> for some details of using a ControlPort-based monitor application, gr-perf-monitorx, for visualizing the counters. This application is particularly useful in learning which blocks are the computationally complex blocks that could use extra optimization or work to improve their performance. It can also be used to understand the current 'health' of the application. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
